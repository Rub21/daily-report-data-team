<!DOCTYPE html>
<meta charset="utf-8">
<style>

    body {
        overflow-y:scroll;
    }

    text {
        font: 12px sans-serif;
    }

    svg {
        display: block;
    }

    #chart{
        margin-top: 50px;

    }

</style>
<body>
 <script  src="lib/jquery-2.1.1.min.js"></script>
<link rel="stylesheet" href="lib/bootstrap.min.css">
<link rel="stylesheet" href="lib/bootstrap-theme.min.css">
<script src="lib/bootstrap.min.js"></script>

    <!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Progress fron Team-Data</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#day">Today</a></li>
            <li><a href="#week">Per Week</a></li>
            <li><a href="#month">Per Month</a></li>        
          </ul>   
        </div>
      </div>
    </div>
    <div id="chartZoom">
        <a href="#" id="zoomIn">Zoom In</a> <a href="#" id="zoomOut">Zoom Out</a>
    </div>

    <div id="chart" class='with-transitions'>
        <svg></svg>
    </div>
    <link href="src/nv.d3.css" rel="stylesheet" type="text/css">
    <script src="lib/d3.v3.js"></script>
    <script src="lib/nv.d3.js"></script>
    <script src="src/tooltip.js"></script>
    <script src="src/utils.js"></script>
    <script src="src/models/legend.js"></script>
    <script src="src/models/axis.js"></script>
    <script src="src/models/scatter.js"></script>
    <script src="src/models/line.js"></script>
    <script src="src/models/lineChart.js"></script>
   
    <script>
    //var host='http://localhost:3021/';
    var host='http://54.172.94.3:3021/'
    $.ajax({
            dataType: "json",
            url: +document.URL.split('#')[1],
            success: function(json) {

                draw(json);
            }
        });
        function draw(json) {
            nv.addGraph(function() {
                var chart = nv.models.lineChart();
                var fitScreen = false;
                var width = 500;
                var height = 200;
                var zoom = 4;

                chart.useInteractiveGuideline(true);
                //chart.xAxis.axisLabel('Hora').tickFormat(d3.format(',r'));
                     chart.xAxis.axisLabel('Hour').tickFormat(function(d) { 
                    return d +' H';
                     });

                chart.yAxis
                        .axisLabel('ChangeSets');

                d3.select('#chart svg')
                        .attr('perserveAspectRatio', 'xMinYMid')
                        .attr('width', width)
                        .attr('height', height)
                        .datum(json);

                setChartViewBox();
                resizeChart();
                nv.utils.windowResize(resizeChart);
                d3.select('#zoomIn').on('click', zoomIn);
                d3.select('#zoomOut').on('click', zoomOut);

                function setChartViewBox() {
                    var w = width * zoom,
                            h = height * zoom;

                    chart
                            .width(w)
                            .height(h);

                    d3.select('#chart svg')
                            .attr('viewBox', '0 0 ' + w + ' ' + h)
                            .transition().duration(500)
                            .call(chart);
                }

                function zoomOut() {
                    zoom += .25;
                    setChartViewBox();
                }

                function zoomIn() {
                    if (zoom <= .5)
                        return;
                    zoom -= .25;
                    setChartViewBox();
                }

                function resizeChart() {
                    var container = d3.select('#chart');
                    var svg = container.select('svg');

                    if (fitScreen) {   
                        var windowSize = nv.utils.windowSize();
                        svg.attr("width", windowSize.width);
                        svg.attr("height", windowSize.height);
                    } else {
                        var aspect = chart.width() / chart.height();
                        var targetWidth = parseInt(container.style('width'));
                        svg.attr("width", targetWidth);
                        svg.attr("height", Math.round(targetWidth / aspect));
                    }
                };
                return chart;
            });
        }
    </script>
